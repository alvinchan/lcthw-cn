\chapter{Exercise 3: 格式化打印输出}

请保留 \file{Makefile}  文件，因为它可以帮你找到错误，而且将来我们要把更多任务自动化时，我们还会往里面添加内容。

许多编程语言使用 C 风格的格式化输出, 让我们来试一下吧:

\begin{code}{ex3.c}
<< d['code/ex3.c|pyg|l'] >>
\end{code}

完成之后运行 \shell{make ex3} 去 build 并运行它. 
确保你\emph{解决了所有警告信息}。

这些练习里只有很少的代码，下面就来详解一下：

\begin{enumerate}
\item 首先引入另一个叫做 \file{stdio.h} 的“头文件（header file）|。 这样做就是告诉编译器你要使用"标准输入输出函数(standard Input/Output functions)"。\ident{printf} 就是这些函数之一。
\item 接着你用一个叫做 \ident{age} 的变量并且给它赋值为 10。
\item 下一步你给变量 \ident{height} 赋值为 72。
\item 然后你用 \ident{printf} 函数打印了这个星球上个子最高的 10  岁小孩的年龄和身高。
\item 在 \ident{printf} 函数中你会注意到你传进了一个字符串，这个字符串和别的语言中的格式化字符串很像。
\item 在这个格式化字符串的后面，你放置了一些变量，这些变量是用以“取代” \ident{printf} 中格式化字符串的。
\end{enumerate}

这么做的结果就是你把几个变量交给 \ident{printf}，然后它构造出一个新的字符串并且在终端中打印这个新的字符串。

\section{你应该看到的结果}

当你做完了整个 build，你会看到类似如下的结果：

\begin{Terminal}{Building and running ex3.c}
\begin{lstlisting}
<< d['code/ex3.out|dexy'] >>
\end{lstlisting}
\end{Terminal}

很快我就不会再告诉你让你运行 \file{make} 、查看 build 信息这些事情了， 所以请确保你现在能把这些东西弄对，确保没有差错。

\section{外部研究}

在每个练习的\emph{加分习题}部分，我也许会让你亲自去查找一些信息并弄明白它们。 要成为一名自食其力的程序员，这一点是很重要的。 如果你老是自己不尝试解决就跑去别人那问问题，你就永远也学不会如何独立的解决问题。这就导致你永远树立不了技术方面的信心，而且你总需要有人在身旁才能做自己的工作。

打破这种习惯的方法就是\emph{强制}你自己先回答自己的问题，然后确认你是对的。 寻找答案的方法可以是试验着让东西出错，用你认为可能的答案去做实验，以及自己学习专研。

这个练习中我希望你能自己上网，找出\emph{所有} \ident{printf} 的转义符和修饰符。转义符是
\verb|\n| 和 \verb|\t| 这类的，它们可以（分别）让你打印出一个空行和制表符. 修饰符是 \verb|%s| 和 \verb|%d| 这类的， 它们可以让你打印出一个字符串和一个整形数。找出所有可能的符号， 学习它们的用法，以及你可以控制它们实现什么样的“精度”和显示宽度。

从现在起，这样的任务就会出现在你的加分习题中，这些练习是你应该做的。

\section{让程序出错}

试试以下这些方法来让你的程序出错，也许这些方法会让程序崩溃，不过也不一定：

\begin{enumerate}
\item 在第一次调用 \ident{printf} 时，删掉 \ident{age} 变量然后重新编译。应该会收到几条警告信息。
\item 运行这个程序的话，你的程序可能会报错，或者输出一个相当不合理的年龄值。
\item 将 \ident{printf} 改回原样，但不要给 \ident{age} 变量赋值，取而代之的是将这行改为 \ident{int age;} 然后重新 build 并运行.
\end{enumerate}


\begin{Terminal}{Breaking ex3.c}
\begin{lstlisting}
<< d['code/ex3.bad.out|dexy'] >>
\end{lstlisting}
\end{Terminal}

\section{加分习题}

\begin{enumerate}
\item 尽你所能的用别的方法去修改 \file{ex3.c} 让它出错。
\item 运行 \verb|man 3 printf| 然后阅读其他带 '\%' 的修饰符，如果你在别的语言中使用过字符串修饰符，这会看起来很熟悉 (其他语言中的字符串修饰符就是从 \ident{printf} 来的).
\item 把 \file{ex3} 加入到你的\file{Makefile} 的 \ident{all} 列表，使用这个 Makefile 运行 \verb|make clean all| 来重新 build 你做过的所有习题。
\item 把 \file{ex3} 这个文件也加到 \file{Makefile} 的 \ident{clean} 列表中。现在使用 \verb|make clean| 将会把它也删除掉。
\end{enumerate}


